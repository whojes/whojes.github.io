I"š<p>Collector ëŠ”, ì•„ë¬´ë˜ë„, Collection Framework ì˜ ê½ƒì´ ì•„ë‹ê¹Œ? ì´ë¦„ë¶€í„° ê·¸ë ‡ì–ì•„. Collector!</p>

<p>â€‹</p>

<p>stream ì˜ ëì—ëŠ” ê±°ì˜ forEach ë‚˜ collect ê°€ ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤. ì—¬ëŸ¬ í•„í„°, ì •ë ¬, ë§¤í•‘ ë“±ë“±ìœ¼ë¡œë¶€í„° ì‚´ì•„ë‚¨ì€ ìŠ¤íŠ¸ë¦¼ì˜ ì—˜ë ˆë¨¼íŠ¸ë“¤ì€ forEach ë¥¼ ë§Œë‚˜ ì†Œë©¸í•˜ê±°ë‚˜ collector ë¥¼ ë§Œë‚˜ ìƒˆë¡œìš´ Return Typeìœ¼ë¡œ ë°˜í™˜ì´ ë˜ê²Œ ëœë‹¤. forEachëŠ” argument ë¡œ Consumer&lt;? super ElementType&gt; ë¥¼ ë°›ìœ¼ë¯€ë¡œ ê·¸ëƒ¥ í•¨ìˆ˜ ê¼´ì„ í•˜ê³  ìˆëŠ” pseudo-ì¼ê¸‰ê°ì²´ í•˜ë‚˜ë¥¼ ë„£ì–´ì£¼ë©´ ë˜ì§€ë§Œ, collectëŠ” argumentê°€ Collector&lt;? super ElementType, A, R&gt; ì„ ë°›ëŠ”ë°, ì•„ë‹ˆ ë„ëŒ€ì²´ê°€ javadocë§Œì½ì–´ì„œëŠ” ì˜ ì´í•´ê°€ ë˜ì§€ ì•Šì•˜ë˜ ê²ƒì´ë‹¤. functional interface ë„ ì•„ë‹ˆê³ , ì–´ì°¨í”¼ java.util.stream.Collectors ì— ìœ ìš©í•œê±´ ì´ë¯¸ ë‹¤ìˆìœ¼ë‹ˆ ê·¸ëƒ¥ ê°–ë‹¤ê°€ ì“°ë©´ ë˜ë‹ˆê¹Œ ì¼ëŠ”ë°, ê·¸ë˜ë„ í•˜ë‚˜ì¯¤ custom collector ê°€ ìˆì–´ì•¼í•˜ì§€ ì•Šì„ê¹Œ? í•˜ëŠ” ë…¸íŒŒì‹¬ì—, ê·¸ë˜! í•´ë³´ì í•˜ê³  ì•Œì•„ë³´ê²Œ ë˜ì—ˆë‹¤.</p>

<p>Collector&lt;T, A, R&gt; í´ë˜ìŠ¤ëŠ” Target, Accumulator, Returnì˜ generic íƒ€ì…ì„ ê°€ì§€ëŠ” ì¸í„°í˜ì´ìŠ¤ì´ê³ , ì´ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ê°€ supplier, accumulator, combiner, finisherì™€ characteristics ë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ stream ì˜ collect ë©”ì„œë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.</p>

<p>â€‹</p>

<p>ì´ë¥¼ ì´ìš©í•´ <code class="language-plaintext highlighter-rouge">java.util.stream.Collectors</code> ì˜ <code class="language-plaintext highlighter-rouge">joining(String delimeter)</code> ë©”ì„œë“œë¥¼ ì§ì ‘ êµ¬í˜„í•´ë³´ë©´,</p>

<p>public class CustomCollector<T> extends Collector&lt;T, StringBuilder, String&gt; {
  private String delimeter_;
  private CustomCollector(String del) {
    delimeter_ = del;
  }
  public static <T> CustomCollector<T> joining(String del) {
    return new CustomCollector&lt;&gt;(del);
  }</T></T></T></p>

<p>@Override
  public Supplier<StringBuilder> supplier() {
    return StringBuilder::new;
  }
  @Override
  public BiConsumer&lt;StringBuilder, T&gt; accumulator() {
    return (sb, value) -&gt; sb.append(value).append(delimeter_);
  }
  @Override
  public BinaryOperator<StringBuilder> combiner() {
    return (sb1, sb2) -&gt; sb1.append(sb2);
  }</StringBuilder></StringBuilder></p>

<p>@Override
  public Function&lt;StringBuilder, String&gt; finisher() {
    return sb -&gt; sb.subSequence(0, sb.length() - delimeter_.length()).toString();
  }</p>

<p>@Override
  public Set<Characteristics> characteristics() {
    return ImmutableSet.of(Characteristics.UNORDERED);
  }
}
ì •ë„ê°€ ë˜ê² ë‹¤. Accumulator ë¡œ StringBuilder ë¥¼ ì‚¬ìš©í–ˆê³ , combiner(2016ë…„ ìŠ¤íƒì˜¤ë²„í”Œë¡œì— ì˜í•˜ë©´ parallel streamìœ¼ë¡œ ë³‘ë ¬ì ìœ¼ë¡œ ì—¬ëŸ¬ ì‘ì—…ì´ ì´ë£¨ì–´ì§€ê³  ì´ ì‘ì—…ë“¤ì„ í•©ì¹  ë•Œë§Œ ì‚¬ìš©ë¨)ë° finisher, delimeter ë¥¼ ì‚½ì…í•˜ëŠ” ë°©ë²•ì€ ìµœì í™”ë¥¼ í•˜ì§€ ì•Šê³  ìƒê°ë‚˜ëŠ”ëŒ€ë¡œ ì§œì„œ íš¨ìœ¨ì€ ëª¨ë¥´ê² ì§€ë§Œ, ì–´ì¨Œë“  ì´ë ‡ê²Œ í•´ ë†“ìœ¼ë©´ java.util.stream.Collectors.joining ê³¼ ë™ì¼í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë¬¼ë¡  ì‹¤ì œë¡œëŠ” java.util.StringJoiner ë¥¼ accumulatorë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ë‹¤.</Characteristics></p>

<p>List<String> list = Arrays.asList("dalee","jumping","higher");
String value = list.stream().collect(CustomCollector.joining("::"));
System.out.println(value);
// dalee::jumping::higher
â€‹</String></p>

<p>Collector.of ë©”ì„œë“œë¥¼ ì´ìš©í•˜ë©´ ì´ê²ƒ ì—­ì‹œ í•¨ìˆ˜í˜•íƒœ(í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•´ í•¨ìˆ˜ í˜•íƒœë¥¼ ì¼ê¸‰ê°ì²´ë¡œ ì‚¬ìš©í•˜ê¸°ìœ„í•œ Javaì˜ ëª¸ë¶€ë¦¼ì´ë¼ê³  ë³¼ìˆ˜ìˆê² ë‹¤.) argumentë¥¼ ì´ìš©í•´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p>String delimeter = â€œ::â€;
Collector&lt;String, ?, String&gt; c = Collector.of(
  StringBuilder::new,  // supplier
  (sb, t) -&gt; sb.append(t).append(delimeter), // accumulator
  StringBuilder::append, // combiner
  sb -&gt; sb.subSequence(0, sb.length() - delimeter.length()).toString(), // finisher
  Characteristics.UNORDERED // characteristics
);
â€‹</p>

<p>â€‹</p>

<p>ë”í•˜ì—¬, double colon ìœ¼ë¡œ ì´ë¤„ì§€ëŠ” method reference ì— ê´€í•˜ì—¬, í•¨ìˆ˜ í˜•íƒœì˜ ëŒë‹¤ì‹ì˜ ì‚¬ìš©ì„ ê°„í¸í•˜ê²Œ í•´ì£¼ëŠ” ê²ƒìœ¼ë¡œ, í¬ê²Œ 4ê°€ì§€ì˜ ì‚¬ìš©ë²•ì´ ìˆë‹¤.</p>

<p>(args) -&gt; Class.staticMethod(args) === Class::staticMethod
(obj, args) -&gt; obj.instanceMethod(args) === ObjectType::instanceMethod
(args) -&gt; obj.instanceMethod(args) === obj::instanceMethod
(args) -&gt; new ClassName(args) === ClassName::new
ì¦‰, ë‹¤ìŒê³¼ ê°™ì´ ì¤„ì¼ ìˆ˜ ìˆë‹¤.</p>

<p>Supplier<StringBuilder> s = () -&gt; new StringBuilder();
Supplier<StringBuilder> s = StringBuilder::new;
// ë™ì¹˜</StringBuilder></StringBuilder></p>

<p>Function&lt;String, StringBuilder&gt; f = (input) -&gt; new StringBuilder(input);
Function&lt;String, StringBuilder&gt; f = StringBuilder::new;
BiFunction&lt;String, String, StringBuilder&gt; f = StringBuilder::new; // Error (StringBuilder ì˜ ìƒì„±ìëŠ” param ì„ 1ê°œë§Œ ë°›ìŒ)
// ë™ì¹˜</p>

<p>BiFunction&lt;String, String, String&gt; bf = (input1, input2) -&gt; input1 + input2;
BiFunction&lt;String, String, String&gt; bf = String::concat;
// ë™ì¹˜</p>

<p>Integer temp = 4;
Comparable<Integer> cc = input -&gt; temp.compareTo(input);
Comparable<Integer> cc = temp::compareTo;
// ë™ì¹˜</Integer></Integer></p>
:ET
<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="shortcut icon" href="/assets/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js" charset="utf-8"></script> <script type="text/javascript" src="/assets/js/vendor/lunr.stemmer.support.min.js" charset="utf-8"></script> <script type="text/javascript" src="/assets/js/vendor/lunr.kr.min.js" charset="utf-8"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>bash commands | whojes blog</title><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="bash commands" /><meta property="og:locale" content="en_US" /><meta name="description" content="이야기 이야기" /><meta property="og:description" content="이야기 이야기" /><link rel="canonical" href="http://localhost:4000/develop/etc/bash" /><meta property="og:url" content="http://localhost:4000/develop/etc/bash" /><meta property="og:site_name" content="whojes blog" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="bash commands" /> <script type="application/ld+json"> {"url":"http://localhost:4000/develop/etc/bash","headline":"bash commands","dateModified":"2021-10-22T23:35:44+09:00","description":"이야기 이야기","@type":"WebPage","@context":"https://schema.org"}</script><body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="http://localhost:4000/" class="site-title lh-tight"> whojes blog </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><div class="site-namecard"> <img class="site-namecard-image" src="/assets/images/dalee.jpeg" /><div class="site-namecard-name"> <text>달리는 개발자</text></div></div><nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:4000/" class="nav-list-link">whojes?</a><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/develop" class="nav-list-link">개발</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/develop/study" class="nav-list-link">study</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/develop/study/oidc" class="nav-list-link">OpenID Connect</a><li class="nav-list-item "> <a href="http://localhost:4000/develop/study/kubevirt" class="nav-list-link">kubevirt</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/develop/java" class="nav-list-link">java/kotlin</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/develop/java/collector" class="nav-list-link">Java collectors</a><li class="nav-list-item "> <a href="http://localhost:4000/develop/java/filer" class="nav-list-link">Java filer</a><li class="nav-list-item "> <a href="http://localhost:4000/develop/java/doublebraces" class="nav-list-link">double curly braces</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/develop/git" class="nav-list-link">git</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/develop/git/plumbing" class="nav-list-link">plumbing commands</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/develop/springboot" class="nav-list-link">springboot</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/develop/springboot/optimize-api" class="nav-list-link">api 최적화와 gzip</a><li class="nav-list-item "> <a href="http://localhost:4000/develop/springboot/kafka-consumer-health" class="nav-list-link">kafka consumer health</a><li class="nav-list-item "> <a href="http://localhost:4000/develop/springboot/shutdown-hook" class="nav-list-link">shutdown hook</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/develop/etc" class="nav-list-link">etc</a><ul class="nav-list"><li class="nav-list-item active"> <a href="http://localhost:4000/develop/etc/bash" class="nav-list-link active">bash commands</a><li class="nav-list-item "> <a href="http://localhost:4000/develop/etc/sorry-computers" class="nav-list-link">미안해 컴퓨터야</a></ul></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/travel" class="nav-list-link">여행</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/travel/asia" class="nav-list-link">아시아</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/travel/asia/vietnam_1" class="nav-list-link">2017-08 베트남</a><li class="nav-list-item "> <a href="http://localhost:4000/travel/asia/japan_1" class="nav-list-link">2019-02 일본 도쿄</a><li class="nav-list-item "> <a href="http://localhost:4000/travel/asia/china_1" class="nav-list-link">2019-08 중국 칭다오</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/travel/europe" class="nav-list-link">유럽</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/travel/europe/vladik_1" class="nav-list-link">2019-10 블라디보스톡</a></ul></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/life" class="nav-list-link">일상</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/life/diary" class="nav-list-link">다이어리</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/life/diary/2022" class="nav-list-link">2022</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/life/essay" class="nav-list-link">에세이</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/life/essay/1" class="nav-list-link">#1</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/life/finance" class="nav-list-link">재테크</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/life/finance/1" class="nav-list-link">집</a></ul></ul><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/cats" class="nav-list-link">고양이</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/cat/dalee" class="nav-list-link">첫째</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:4000/cat/dalee/1" class="nav-list-link">#1</a><li class="nav-list-item "> <a href="http://localhost:4000/cat/dalee/2" class="nav-list-link">#2</a><li class="nav-list-item "> <a href="http://localhost:4000/cat/dalee/3" class="nav-list-link">#3</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:4000/cat/second" class="nav-list-link">둘째</a><ul class="nav-list"></ul></ul></ul></nav></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="search in whojes blog" aria-label="search in whojes blog" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/develop">개발</a><li class="breadcrumb-nav-list-item"><a href="http://localhost:4000/develop/etc">etc</a><li class="breadcrumb-nav-list-item"><span>bash commands</span></ol></nav><div style="height: 0.5rem"></div><div id="main-content" class="main-content" role="main"><div> <span style="font-size: 1.8rem; "> bash commands </span><br> <span style="padding-top: 0.5rem; color: lightgrey;">created at 2019.05.16</span><hr/></div><h3 id="contents"> <a href="#contents" class="anchor-heading" aria-labelledby="contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> contents</h3><ol><li><a href="#1-basic">basic</a><li><a href="#2-default-value">default value</a><li><a href="#3-if-조건문">if 조건문</a><li><a href="#4-xargs">xargs</a><li><a href="#5-awk">awk</a><li><a href="#6-command">command</a><li><a href="#7-trap">trap</a><li><a href="#8-pipefail">pipefail</a><li><a href="#9-exec">exec</a><li><a href="#10-shift">shift</a></ol><h3 id="1-basic"> <a href="#1-basic" class="anchor-heading" aria-labelledby="1-basic"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. basic</h3><ul><li>pipeline<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  |, <span class="o">||</span>, &amp;, <span class="o">&amp;&amp;</span>
</code></pre></div></div><p>| 는 파이프라인, 좌측 명령어의 stdout 을 우측 명령어의 argument로 전달 &amp;는 명령어를 backgroud로 실행, exit code 를 0으로 보냄 (터미널은 붙어있으니 필요시 적절하게 /dev/null 이나 기타 로그파일로 리디렉트해줘야함) || 는 or 연산자, 좌측 명령어의 exit code가 0이 아닐경우 우측 명령어 실행<br /> &amp;&amp; 는 and 연산자, 좌측 명령어의 exit code 가 0일 경우 우측 명령어 실행</p><li><p>type</p><p>shell script 를 짜는데 유용한 built-in command 가 몇개 있다. 늘상 쓰는 pwd, export, source, exit 외에 몇 가지 binary인줄 알았는데 bash builtin 인것도 있음을 발견했다. cd, echo, history (!), alias 도 builtin 명령어들이었다. builtin 인지 아닌지 확인하는 builtin command 가 있다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  :~<span class="nv">$ </span><span class="nb">type</span> <span class="nt">-f</span> <span class="k">${</span><span class="nv">cmd</span><span class="k">}</span>
</code></pre></div></div></ul><h3 id="2-default-value"> <a href="#2-default-value" class="anchor-heading" aria-labelledby="2-default-value"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. default value</h3><p>bash 스크립트 중 parameter 인풋이 없으면 default 로 설정하는 명령어</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">[</span> <span class="nt">-z</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="o">]</span> <span class="k">then
    </span>version <span class="o">=</span> <span class="s2">"default"</span>
<span class="k">else
    </span>version <span class="o">=</span> <span class="nv">$1</span>
<span class="k">fi</span> 
</code></pre></div></div><p>대충 이럴텐데 (테스트는 안해봄),</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version <span class="o">=</span> <span class="k">${</span><span class="p">@</span><span class="k">:-</span><span class="nv">default</span><span class="k">}</span>
</code></pre></div></div><p>그냥 이렇게 쓰면 된단다. 나참…. 문법이 으이구 이걸 어떻게 알아보나이거 배쉬놈들</p><h3 id="3-if-조건문"> <a href="#3-if-조건문" class="anchor-heading" aria-labelledby="3-if-조건문"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. if 조건문</h3><p>bash 문법은 if 조건문을 사용할 때</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">[</span> A <span class="o">==</span> B <span class="o">]</span> 
<span class="k">if</span> <span class="o">[</span> C <span class="o">!=</span> D <span class="o">]</span>
</code></pre></div></div><p>이게 아니라</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">[</span> A <span class="nt">-eq</span> B <span class="o">]</span>
<span class="k">if</span> <span class="o">[</span> C <span class="nt">-ne</span> D <span class="o">]</span>
</code></pre></div></div><p>이렇게 써야한다. 이런 예시는 좀 빡치지만 (bash 를 잘 안쓰면 쓸 때마다 검색해야하게만든다), 훨씬 더 많은 비교 및 조사를 할 수 있게 되는 것 같다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span> <span class="nt">-d</span> <span class="o">]</span> : 파일이 디렉토리면 
<span class="o">[</span> <span class="nt">-e</span> <span class="o">]</span> : 파일이 있으면 참
<span class="o">[</span> <span class="nt">-L</span> <span class="o">]</span> : 파일이 심볼릭 링크면 참
<span class="o">[</span> <span class="nt">-r</span> <span class="o">]</span> : 파일이 읽기 가능하면 참
<span class="o">[</span> <span class="nt">-s</span> <span class="o">]</span> : 파일의 크기가 0 보다 크면 참
<span class="o">[</span> <span class="nt">-w</span> <span class="o">]</span> : 파일이 쓰기 가능하면 참
<span class="o">[</span> <span class="nt">-x</span> <span class="o">]</span> : 파일이 실행 가능하면 참
<span class="o">[</span> 파일1 <span class="nt">-nt</span> 파일2 <span class="o">]</span>  : 파일1이 파일2보다 최신파일이면 참
<span class="o">[</span> 파일1 <span class="nt">-ot</span> 파일2 <span class="o">]</span>  : 파일1이 파일2보다 이전파일이면 참
<span class="o">[</span> 파일1 <span class="nt">-ef</span> 파일2 <span class="o">]</span> : 파일1이 파일2랑 같은 파일이면 참 

// 출처: https://jink1982.tistory.com/48 <span class="o">[</span>돼민이] 
</code></pre></div></div><p>등의 수많은 variation 이 가능하다. 이러면 단순히 같다를 ==로 하게 되면 통일성이 떨어지겠지</p><h3 id="4-xargs"> <a href="#4-xargs" class="anchor-heading" aria-labelledby="4-xargs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. xargs</h3><p>xargs 를 얼마나 잘 활용하는가 하는게 이사람이 쫌 간지나는 사람이구나를 판별하는 척도로 사용할 수 있겠다.</p><p>딱히 bash 랑만 관계있는건 아니지만, bash를 거의 사용하니까…</p><p>사실 대부분 $(명령어) 를 이용해서도 가능하긴 하지만, -0 옵션같은 유용한 사용법이 있어 더 안전하다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> <span class="nt">-al</span> <span class="si">$(</span>find <span class="nb">.</span> <span class="nt">-name</span> <span class="s2">"*.py"</span><span class="si">)</span> 
</code></pre></div></div><p>는 모든 py 스크립트를 찾기에 간편하지만, 파일 이름에 공백이나 다른 특수문자가 있을 경우 명령어 전체에서 에러가 난다. stdout 도 꼬이고 echo $?로 ec를 확인해봐도 1이 나온다. 이를 방지하기 위해</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find <span class="nb">.</span> <span class="nt">-name</span> <span class="s2">"*.py"</span> <span class="nt">-print0</span> | xargs <span class="nt">-0</span> <span class="nb">ls</span> <span class="nt">-al</span>
</code></pre></div></div><p>이런식으로 사용하면 된다. find 의 -print0 옵션은 결과 사이를 개행문자가 아닌 널문자로 구분하도록 stdout 을 내보내는 역할을 하고, xarg의 -0옵션은 공백이 아닌 널문자로 인풋파라미터를 구분하도록 하는 옵션이다. man xargs 를 보면 알겠지만 -0 옵션 자체가 find 의 print0에 대응되도록 만들어졌다.​</p><h3 id="5-awk"> <a href="#5-awk" class="anchor-heading" aria-labelledby="5-awk"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 5. awk</h3><p>아… awk…. 뭔가 웹크롤링할때처럼 text 파일들이나 df, fdisk, lshw 등 명령어의 output을 크롤링할때 많이 써서 보기만해도 기분나쁘다. 그냥… 잘 쓰면 좋은데 그냥 기분나쁘다. 잘 정리된 <a href="https://zzsza.github.io/development/2017/12/20/linux-6/">블로그</a>가 있어 참조한다.</p><h3 id="6-command"> <a href="#6-command" class="anchor-heading" aria-labelledby="6-command"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 6. command</h3><p>해당 명령어는 -v 옵션과함께 사용시 arg 로 들어온 것이 bash 에서 어떤 행동을 하는지 알려준다. (alias가 되어있으면 alias도 알려줌) 이를 이용해 스크립트 내에서 사용하는 바이너리들의 존재여부를 스크립트 시작전에 파악하도록 구성할 수 있다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//내부 스크립트 진행시 <span class="nb">sha256sum</span>, go, javac, java 바이너리는 반드시 필요할 경우
//해당 명령어들을 사전에 <span class="nb">command</span> <span class="nt">-v</span> <span class="k">${</span><span class="nv">cmd</span><span class="k">}</span> 을 통해 진행, exitcode가 0이 아닐경우
//stderr로 에러메세지 뿜고 스크립트 종료
<span class="k">for </span>cmd <span class="k">in </span><span class="nb">sha256sum </span>go javac java<span class="p">;</span> <span class="k">do
if</span> <span class="o">!</span> <span class="nb">command</span> <span class="nt">-v</span> <span class="nv">$cmd</span> &amp;&gt; /dev/null<span class="p">;</span> <span class="k">then  
    </span><span class="nb">echo</span> <span class="o">&gt;</span>&amp;2 <span class="s2">"error: </span><span class="nv">$cmd</span><span class="s2"> not found"</span> 
    <span class="nb">exit </span>1
<span class="k">fi
done</span>
</code></pre></div></div><h3 id="7-trap"> <a href="#7-trap" class="anchor-heading" aria-labelledby="7-trap"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 7. trap</h3><p>trap 명령어는 go 언어의 defer같은 느낌으로다가 사용할수 있는 builtin command이다. 특정 시그널을 받을 때 실행할 명령어를 지정할 수 있다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// 스크립트가 종료될 때 다음 명령어를 수행하도록
<span class="nb">trap</span> <span class="s2">"echo </span><span class="se">\"</span><span class="s2">ALL IS WELL</span><span class="se">\"</span><span class="s2">"</span> EXIT

// ERR SIG를 받을 때 다음 명령어를 수행한다.
<span class="nb">trap</span> <span class="s2">"echo </span><span class="se">\"</span><span class="s2">SOMETHING</span><span class="se">\'</span><span class="s2">S WRONG</span><span class="se">\"</span><span class="s2">"</span> ERR
</code></pre></div></div><h3 id="8-pipefail"> <a href="#8-pipefail" class="anchor-heading" aria-labelledby="8-pipefail"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 8. pipefail</h3><p>스크립트 내부에서 명령어가 실패할경우 bash는 스크립트를 끝내지않고 다음 명령어를 수행한다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">set</span> <span class="nt">-eouE</span> pipefail
</code></pre></div></div><p><code class="language-plaintext highlighter-rouge">-e</code> 옵션은 exit code가 0 이 아닌 커맨드를 만났을 때 script를 진행하지 않고 끝내라는 셋팅이다. (<code class="language-plaintext highlighter-rouge">$cmd || true</code> 등의 명령어를 통해 실패해도 script 종료가 나지 않게 지정할 수 있다.) 다만 이 경우 pipeline 을 통한 명령어가 실행될 때는 pipeline 의 좌측 명령어가 exit code 를 0이 아니게 내뿜어도 우측 명령어가 0이면 에러가 아니게 된다. 즉,</p><div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">ls</span> /not/existing/dir | <span class="nb">grep </span>something
</code></pre></div></div><p>같은 명령어의 경우 좌측이 exit code 2로 나와도 파이프라인을 받는 명령어가 exit code를 0을 내밀기에 해당 스크립트는 여전히 진행된다. 이를 막기위해서 -o pipefail 옵션도 주면 된다. <code class="language-plaintext highlighter-rouge">-E</code> 옵션을 주지 않으면 위의 trap이 지정한 ERR SIG를 캐치하지 못한다.</p><p><code class="language-plaintext highlighter-rouge">-u</code> 옵션은 setting 되지 않은 환경변수를 호출했을 때 empty를 return하지 않고 script를 종료시킨다.</p><p>setting 되지 않은 환경변수 하니까 나온건데 지난번 <code class="language-plaintext highlighter-rouge">${@:-default}</code> 는 <code class="language-plaintext highlighter-rouge">${a:-b}</code> 문법의 확장판이다. a라는 변수가 있으면 a로 세팅하고 없으면 b로 하라는 말이다. -u 옵션은 이 문법에서 a가 세팅되어있지않더라도 에러를뿜거나 하지는 않는다.</p><p>추가로, 디버깅을 위해 명령어가 실행되기 전 명령어를 인쇄하도록 하고싶으면 <code class="language-plaintext highlighter-rouge">-x</code> 옵션을 사용하면 된다. ​</p><h3 id="9-exec"> <a href="#9-exec" class="anchor-heading" aria-labelledby="9-exec"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 9. exec</h3><p>명령어를 실행하되 실행한 bash 의 하위 프로세스로 돌리는게 아니고 실행한 프로세스의 pid를 물려받아 실행하도록 한다. 허접은 잘 쓸수가 없다.</p><h3 id="10-shift"> <a href="#10-shift" class="anchor-heading" aria-labelledby="10-shift"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 10. shift</h3><p>$1, $2 … 등으로 사용하는 input args 를 왼쪽으로 한칸씩 이동할 때 쓴다. 왜있는건지 도통 모르겠다. 고수들은 잘쓰려나? 약간 java iterable 같은거에서 cursor 옮기는 느낌이려나</p><hr><p><a href="#top" id="back-to-top">맨 위로 가기</a></p><b>etc의 다른 글 보기</b><p><a href="/develop/etc/sorry-computers">미안해 컴퓨터야</a></p><footer><style> #share-buttons {display: inline-block; vertical-align: middle; } #share-buttons:after {content: ""; display: block; clear: both;} #share-buttons > div { position: relative; text-align: left; height: 36px; width: 32px; float: left; text-align: center; } #share-buttons > div > svg {height: 16px; fill: #d5d5d5; margin-top: 10px;} #share-buttons > div:hover {cursor: pointer;} #share-buttons > div.facebook:hover > svg {fill: #3B5998;} #share-buttons > div.twitter:hover > svg {fill: #55ACEE;} #share-buttons > div.linkedin:hover > svg {fill: #0077b5;} #share-buttons > div.pinterest:hover > svg {fill: #CB2027;} #share-buttons > div.gplus:hover > svg {fill: #dd4b39;} #share-buttons > div.mail:hover > svg {fill: #7D7D7D;} #share-buttons > div.instagram:hover > svg {fill: #C73B92;} #share-buttons > div.facebook > svg {height: 18px; margin-top: 9px;} #share-buttons > div.twitter > svg {height: 20px; margin-top: 8px;} #share-buttons > div.linkedin > svg {height: 19px; margin-top: 7px;} #share-buttons > div.pinterest > svg {height: 20px; margin-top: 9px;} #share-buttons > div.gplus > svg {height: 17px; margin-top: 9px; position: relative; left: 1px;} #share-buttons > div.mail > svg {height: 14px; margin-top: 11px;}</style><span style="color: silver;">Share this on: </span><div id="share-buttons"><div class="facebook" title="Share this on Facebook" onclick="window.open('http://www.facebook.com/share.php?u=http://localhost:4000/develop/etc/bash');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z"/></svg></div><div class="twitter" title="Share this on Twitter" onclick="window.open('http://twitter.com/home?status=http://localhost:4000/develop/etc/bash');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z"/></svg></div><div class="linkedin" title="Share this on Linkedin" onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/develop/etc/bash&title=&summary=&source=');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z"/></svg></div><div class="mail" title="Share this through Email" onclick="window.open('mailto:?&body=http://localhost:4000/develop/etc/bash');"><svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg"><path d="M1792 710v794q0 66-47 113t-113 47h-1472q-66 0-113-47t-47-113v-794q44 49 101 87 362 246 497 345 57 42 92.5 65.5t94.5 48 110 24.5h2q51 0 110-24.5t94.5-48 92.5-65.5q170-123 498-345 57-39 100-87zm0-294q0 79-49 151t-122 123q-376 261-468 325-10 7-42.5 30.5t-54 38-52 32.5-57.5 27-50 9h-2q-23 0-50-9t-57.5-27-52-32.5-54-38-42.5-30.5q-91-64-262-182.5t-205-142.5q-62-42-117-115.5t-55-136.5q0-78 41.5-130t118.5-52h1472q65 0 112.5 47t47.5 113z"/></svg></div></div><div class="d-flex mt-2"></div></footer></div></div><div class="search-overlay"></div></div>
